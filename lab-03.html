<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>biostat-620-lab-3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="lab-03_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab-03_files/libs/quarto-html/quarto.js"></script>
<script src="lab-03_files/libs/quarto-html/popper.min.js"></script>
<script src="lab-03_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab-03_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab-03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab-03_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab-03_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab-03_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab-03_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="lab-03_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="lab-03_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="lab-03_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="lab-03_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="lab-03_files/libs/leaflet-1.3.1/leaflet.js"></script>

<link href="lab-03_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="lab-03_files/libs/proj4-2.6.2/proj4.min.js"></script>

<script src="lab-03_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="lab-03_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="lab-03_files/libs/leaflet-binding-2.2.3/leaflet.js"></script>

<script src="lab-03_files/libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>

<script src="lab-03_files/libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script>



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">biostat-620-lab-3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="read-in-the-data" class="level1">
<h1>1. Read in the data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>met <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Temp/met_all.gz"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-the-dimensions-headers-footers" class="level1">
<h1>2. Check the dimensions, headers, footers</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(met)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2377343      30</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(met)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2377343</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(met)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
</div>
<p>From the results of dim(), nrow(), and ncol(), there are 2,377,343 records (rows) and 30 variables (columns) in this dataset.</p>
</section>
<section id="take-a-look-at-all-of-the-variables" class="level1">
<h1>3. Take a look at all of the variables</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(met)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2377343 obs. of  30 variables:
 $ USAFID           : int  690150 690150 690150 690150 690150 690150 690150 690150 690150 690150 ...
 $ WBAN             : int  93121 93121 93121 93121 93121 93121 93121 93121 93121 93121 ...
 $ year             : int  2019 2019 2019 2019 2019 2019 2019 2019 2019 2019 ...
 $ month            : int  8 8 8 8 8 8 8 8 8 8 ...
 $ day              : int  1 1 1 1 1 1 1 1 1 1 ...
 $ hour             : int  0 1 2 3 4 5 6 7 8 9 ...
 $ min              : int  56 56 56 56 56 56 56 56 56 56 ...
 $ lat              : num  34.3 34.3 34.3 34.3 34.3 34.3 34.3 34.3 34.3 34.3 ...
 $ lon              : num  -116 -116 -116 -116 -116 ...
 $ elev             : int  696 696 696 696 696 696 696 696 696 696 ...
 $ wind.dir         : int  220 230 230 210 120 NA 320 10 320 350 ...
 $ wind.dir.qc      : chr  "5" "5" "5" "5" ...
 $ wind.type.code   : chr  "N" "N" "N" "N" ...
 $ wind.sp          : num  5.7 8.2 6.7 5.1 2.1 0 1.5 2.1 2.6 1.5 ...
 $ wind.sp.qc       : chr  "5" "5" "5" "5" ...
 $ ceiling.ht       : int  22000 22000 22000 22000 22000 22000 22000 22000 22000 22000 ...
 $ ceiling.ht.qc    : int  5 5 5 5 5 5 5 5 5 5 ...
 $ ceiling.ht.method: chr  "9" "9" "9" "9" ...
 $ sky.cond         : chr  "N" "N" "N" "N" ...
 $ vis.dist         : int  16093 16093 16093 16093 16093 16093 16093 16093 16093 16093 ...
 $ vis.dist.qc      : chr  "5" "5" "5" "5" ...
 $ vis.var          : chr  "N" "N" "N" "N" ...
 $ vis.var.qc       : chr  "5" "5" "5" "5" ...
 $ temp             : num  37.2 35.6 34.4 33.3 32.8 31.1 29.4 28.9 27.2 26.7 ...
 $ temp.qc          : chr  "5" "5" "5" "5" ...
 $ dew.point        : num  10.6 10.6 7.2 5 5 5.6 6.1 6.7 7.8 7.8 ...
 $ dew.point.qc     : chr  "5" "5" "5" "5" ...
 $ atm.press        : num  1010 1010 1011 1012 1013 ...
 $ atm.press.qc     : int  5 5 5 5 5 5 5 5 5 5 ...
 $ rh               : num  19.9 21.8 18.5 16.9 17.4 ...</code></pre>
</div>
</div>
<p>From the results of str(), we see that “met” is a ‘data.frame’ object with numerous variables of types “int” (integer), “num” (double), and “chr” (string). We see that the wind.dir column has at least one missing value (NA).</p>
<p>Some of the variables appear to all be very similar to one another (e.g.&nbsp;USAFID, WBAN, year, ceiling.ht, vis.dist), but we cannot generalize this conclusion to the whole dataset without making a table or visualization of each variable.</p>
</section>
<section id="take-a-closer-look-at-the-key-variables-year-day-hour-temp-elev-wind.sp" class="level1">
<h1>4. Take a closer look at the key variables (year, day, hour, temp, elev, wind.sp)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2019    2019    2019    2019    2019    2019 </code></pre>
</div>
</div>
<p>This shows that the entire dataset was collected in the year 2019.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>hour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    5.00   11.00   11.34   17.00   23.00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(met<span class="sc">$</span>hour)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     0      1      2      3      4      5      6      7      8      9     10 
 99434  93482  93770  96703 110504 112128 106235 101985 100310 102915 101880 
    11     12     13     14     15     16     17     18     19     20     21 
100470 103605  97004  96507  97635  94942  94184 100179  94604  94928  96070 
    22     23 
 94046  93823 </code></pre>
</div>
</div>
<p>This shows that (as one would expect) the “hour” variable keeps track of the hour of the day (from 0:00 to 23:00) at which the observation is recorded. The most common times to record observations are from 4:00 (4 AM) to 12:00 (12 PM), and less observations are recorded late at night (7 PM to 3 AM).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
 -40.00   19.60   23.50   23.59   27.80   56.00   60089 </code></pre>
</div>
</div>
<p>According to the Mandatory Data Section of the data dictionary, we see that temperatures are reported in degrees Celsius. The minimum temperature of -40 degrees Celsius is too cold to be a reasonable measurement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -13.0   101.0   252.0   415.8   400.0  9999.0 </code></pre>
</div>
</div>
<p>We see that the maximum elevation is 9999, which is very unreasonable; reading the data document confirms that 9999 is used to indicate a missing value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>wind.sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  0.000   0.000   2.100   2.459   3.600  36.000   79693 </code></pre>
</div>
</div>
<p>Here, we find that the maximum wind speed is much higher than the rest, which is suspicious.</p>
</section>
<section id="check-the-data-against-an-external-data-source" class="level1">
<h1>5. Check the data against an external data source</h1>
<p>To fix these issues, we first remove values of -40 and NA from the “temp” variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>met <span class="ot">&lt;-</span> met[<span class="sc">!</span><span class="fu">is.na</span>(met<span class="sc">$</span>temp) <span class="sc">&amp;</span> met<span class="sc">$</span>temp <span class="sc">!=</span> <span class="sc">-</span><span class="dv">40</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 -17.20   19.60   23.50   23.59   27.80   56.00 </code></pre>
</div>
</div>
<p>The coldest temperature is now -17.20 degrees Celsius, which is still suspicious. We see from examining all of the records with this tempreature value that they were recorded in month 8 (August).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>met[<span class="sc">!</span><span class="fu">is.na</span>(met<span class="sc">$</span>temp) <span class="sc">&amp;</span> met<span class="sc">$</span>temp <span class="sc">&lt;</span> <span class="dv">0</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        USAFID  WBAN year month day hour min    lat      lon elev wind.dir
252417  720411   137 2019     8  17   12  35 36.422 -105.290 2554       NA
252480  720411   137 2019     8  18    9  35 36.422 -105.290 2554      240
252482  720411   137 2019     8  18   10  15 36.422 -105.290 2554       NA
252483  720411   137 2019     8  18   10  35 36.422 -105.290 2554       NA
252484  720411   137 2019     8  18   10  55 36.422 -105.290 2554       NA
252485  720411   137 2019     8  18   11  15 36.422 -105.290 2554       NA
252486  720411   137 2019     8  18   11  35 36.422 -105.290 2554       NA
252487  720411   137 2019     8  18   11  55 36.422 -105.290 2554       NA
252488  720411   137 2019     8  18   12  15 36.422 -105.290 2554      150
252489  720411   137 2019     8  18   12  35 36.422 -105.290 2554       NA
252490  720411   137 2019     8  18   12  55 36.422 -105.290 2554       NA
252998  720411   137 2019     8  25   12  15 36.422 -105.290 2554       NA
253000  720411   137 2019     8  25   12  55 36.422 -105.290 2554       NA
951475  722221   444 2019     8  27   12  30 41.037 -107.492 1996      130
1105455 722518 12974 2019     8  11   23  56 27.901  -98.052   78      150
1105457 722518 12974 2019     8  12    1  56 27.901  -98.052   78      150
1105459 722518 12974 2019     8  12    3  56 27.901  -98.052   78      160
1203053 722817  3068 2019     8   1    0  56 38.767 -104.300 1838      190
1203054 722817  3068 2019     8   1    1   6 38.767 -104.300 1838      180
1203055 722817  3068 2019     8   1    1  56 38.767 -104.300 1838      180
1203128 722817  3068 2019     8   3   11  56 38.767 -104.300 1838       NA
1203129 722817  3068 2019     8   3   12  56 38.767 -104.300 1838       NA
1203221 722817  3068 2019     8   6   21  39 38.767 -104.300 1838      210
1203222 722817  3068 2019     8   6   21  56 38.767 -104.300 1838      280
1203223 722817  3068 2019     8   6   22  32 38.767 -104.300 1838      260
1203224 722817  3068 2019     8   6   22  41 38.767 -104.300 1838       NA
1203225 722817  3068 2019     8   6   22  56 38.767 -104.300 1838      240
1203226 722817  3068 2019     8   6   23   3 38.767 -104.300 1838      210
1462938 723894  3181 2019     8  11   12  35 37.633 -118.850 2173      340
1462939 723894  3181 2019     8  11   12  55 37.633 -118.850 2173       NA
2091732 725846 93201 2019     8  11   12  55 39.320 -120.139 1798       NA
2356459 726664 94173 2019     8  26   12  56 44.544 -110.421 2388       NA
2356482 726664 94173 2019     8  27   10  56 44.544 -110.421 2388       NA
2356483 726664 94173 2019     8  27   11  56 44.544 -110.421 2388      310
2356484 726664 94173 2019     8  27   12  56 44.544 -110.421 2388       NA
2367816 726710 24164 2019     8  28   12  53 42.584 -110.107 2126       NA
2370112 726764 94163 2019     8  18   11  50 44.683 -111.116 2025       NA
2370113 726764 94163 2019     8  18   12  10 44.683 -111.116 2025       NA
2370114 726764 94163 2019     8  18   12  25 44.683 -111.116 2025       NA
2370115 726764 94163 2019     8  18   12  50 44.683 -111.116 2025       NA
2370686 726764 94163 2019     8  26   11  45 44.683 -111.116 2025       NA
2370687 726764 94163 2019     8  26   12  10 44.683 -111.116 2025       NA
2370688 726764 94163 2019     8  26   12  30 44.683 -111.116 2025       NA
2370689 726764 94163 2019     8  26   12  50 44.683 -111.116 2025       NA
2370690 726764 94163 2019     8  26   13  10 44.683 -111.116 2025       NA
2370752 726764 94163 2019     8  27    9  45 44.683 -111.116 2025       NA
2370753 726764 94163 2019     8  27   10  10 44.683 -111.116 2025       NA
2370754 726764 94163 2019     8  27   10  30 44.683 -111.116 2025       NA
2370755 726764 94163 2019     8  27   10  50 44.683 -111.116 2025       40
2370756 726764 94163 2019     8  27   11  10 44.683 -111.116 2025       NA
2370757 726764 94163 2019     8  27   11  25 44.683 -111.116 2025       NA
2370758 726764 94163 2019     8  27   11  50 44.683 -111.116 2025       NA
2370759 726764 94163 2019     8  27   12  10 44.683 -111.116 2025       NA
2370760 726764 94163 2019     8  27   12  30 44.683 -111.116 2025       NA
2370761 726764 94163 2019     8  27   12  50 44.683 -111.116 2025       NA
2370762 726764 94163 2019     8  27   13  10 44.683 -111.116 2025       NA
2370763 726764 94163 2019     8  27   13  25 44.683 -111.116 2025      220
2370829 726764 94163 2019     8  28   11  30 44.683 -111.116 2025       NA
2370830 726764 94163 2019     8  28   11  50 44.683 -111.116 2025       NA
2370831 726764 94163 2019     8  28   12  10 44.683 -111.116 2025       NA
2370832 726764 94163 2019     8  28   12  30 44.683 -111.116 2025       NA
2370833 726764 94163 2019     8  28   12  45 44.683 -111.116 2025       NA
2370834 726764 94163 2019     8  28   13  10 44.683 -111.116 2025       NA
2370901 726764 94163 2019     8  29   11  30 44.683 -111.116 2025      210
2370902 726764 94163 2019     8  29   11  45 44.683 -111.116 2025       NA
2370903 726764 94163 2019     8  29   12   5 44.683 -111.116 2025       NA
2370904 726764 94163 2019     8  29   12  25 44.683 -111.116 2025       NA
2370905 726764 94163 2019     8  29   12  45 44.683 -111.116 2025       NA
2370906 726764 94163 2019     8  29   13  10 44.683 -111.116 2025      210
        wind.dir.qc wind.type.code wind.sp wind.sp.qc ceiling.ht ceiling.ht.qc
252417            9              C     0.0          5      22000             5
252480            5              N     2.1          5      22000             5
252482            9              C     0.0          5      22000             5
252483            9              C     0.0          5      22000             5
252484            9              C     0.0          5      22000             5
252485            9              C     0.0          5      22000             5
252486            9              C     0.0          5      22000             5
252487            9              C     0.0          5      22000             5
252488            5              N     1.5          5      22000             5
252489            9              C     0.0          5      22000             5
252490            9              C     0.0          5      22000             5
252998            9              C     0.0          5      22000             5
253000            9              C     0.0          5      22000             5
951475            5              N     2.6          5      22000             5
1105455           1              N     8.8          1      22000             1
1105457           1              N     8.2          1      22000             1
1105459           1              N     5.1          1      22000             1
1203053           5              N     7.2          5         NA             9
1203054           5              N     5.1          5         NA             9
1203055           5              N     7.7          5         NA             9
1203128           9              C     0.0          5         NA             9
1203129           9              C     0.0          5         NA             9
1203221           5              N     1.5          5         NA             9
1203222           5              N     2.6          5         NA             9
1203223           5              V    11.8          5         NA             9
1203224           9              V     1.5          5         NA             9
1203225           5              N     7.7          5         NA             9
1203226           5              N     6.7          5         NA             9
1462938           5              N     1.5          5      22000             5
1462939           9              C     0.0          5      22000             5
2091732           9              C     0.0          5        152             5
2356459           9              C     0.0          5         NA             9
2356482           9              C     0.0          5         NA             9
2356483           5              N     1.5          5         NA             9
2356484           9              C     0.0          5         NA             9
2367816           9              C     0.0          5      22000             5
2370112           9              C     0.0          5      22000             5
2370113           9              C     0.0          5      22000             5
2370114           9              C     0.0          5      22000             5
2370115           9              C     0.0          5      22000             5
2370686           9              C     0.0          5      22000             5
2370687           9              C     0.0          5      22000             5
2370688           9              C     0.0          5      22000             5
2370689           9              C     0.0          5      22000             5
2370690           9              C     0.0          5      22000             5
2370752           9              C     0.0          5      22000             5
2370753           9              C     0.0          5      22000             5
2370754           9              C     0.0          5      22000             5
2370755           5              N     1.5          5      22000             5
2370756           9              C     0.0          5      22000             5
2370757           9              C     0.0          5      22000             5
2370758           9              C     0.0          5      22000             5
2370759           9              C     0.0          5      22000             5
2370760           9              C     0.0          5      22000             5
2370761           9              C     0.0          5      22000             5
2370762           9              C     0.0          5      22000             5
2370763           5              N     1.5          5      22000             5
2370829           9              C     0.0          5      22000             5
2370830           9              C     0.0          5      22000             5
2370831           9              C     0.0          5      22000             5
2370832           9              C     0.0          5      22000             5
2370833           9              C     0.0          5      22000             5
2370834           9              C     0.0          5      22000             5
2370901           5              N     1.5          5      22000             5
2370902           9              C     0.0          5      22000             5
2370903           9              C     0.0          5      22000             5
2370904           9              C     0.0          5      22000             5
2370905           9              C     0.0          5      22000             5
2370906           5              N     2.1          5      22000             5
        ceiling.ht.method sky.cond vis.dist vis.dist.qc vis.var vis.var.qc
252417                  9        N    16093           5       N          5
252480                  9        N    16093           5       N          5
252482                  9        N    16093           5       N          5
252483                  9        N    16093           5       N          5
252484                  9        N    16093           5       N          5
252485                  9        N    16093           5       N          5
252486                  9        N    16093           5       N          5
252487                  9        N    16093           5       N          5
252488                  9        N    16093           5       N          5
252489                  9        N    16093           5       N          5
252490                  9        N    16093           5       N          5
252998                  9        N    16093           5       N          5
253000                  9        N    16093           5       N          5
951475                  9        N    16093           5       N          5
1105455                 9        N       NA           9       9          9
1105457                 9        N       NA           9       9          9
1105459                 9        N       NA           9       9          9
1203053                 9        N       NA           9       N          5
1203054                 9        N       NA           9       N          5
1203055                 9        N       NA           9       N          5
1203128                 9        N       NA           9       N          5
1203129                 9        N       NA           9       N          5
1203221                 9        N       NA           9       N          5
1203222                 9        N       NA           9       N          5
1203223                 9        N       NA           9       N          5
1203224                 9        N       NA           9       N          5
1203225                 9        N       NA           9       N          5
1203226                 9        N       NA           9       N          5
1462938                 9        N    16093           5       N          5
1462939                 9        N    16093           5       N          5
2091732                 W        N      805           5       N          5
2356459                 9        N       NA           7       N          5
2356482                 9        N       NA           7       N          5
2356483                 9        N       NA           7       N          5
2356484                 9        N       NA           7       N          5
2367816                 9        N    16093           5       N          5
2370112                 9        N    16093           5       N          5
2370113                 9        N    16093           5       N          5
2370114                 9        N    16093           5       N          5
2370115                 9        N    16093           5       N          5
2370686                 9        N    16093           5       N          5
2370687                 9        N    16093           5       N          5
2370688                 9        N    16093           5       N          5
2370689                 9        N    16093           5       N          5
2370690                 9        N    16093           5       N          5
2370752                 9        N    16093           5       N          5
2370753                 9        N    16093           5       N          5
2370754                 9        N    16093           5       N          5
2370755                 9        N    16093           5       N          5
2370756                 9        N    16093           5       N          5
2370757                 9        N    16093           5       N          5
2370758                 9        N    16093           5       N          5
2370759                 9        N    16093           5       N          5
2370760                 9        N    16093           5       N          5
2370761                 9        N    16093           5       N          5
2370762                 9        N    16093           5       N          5
2370763                 9        N    16093           5       N          5
2370829                 9        N    16093           5       N          5
2370830                 9        N    16093           5       N          5
2370831                 9        N    16093           5       N          5
2370832                 9        N    16093           5       N          5
2370833                 9        N    16093           5       N          5
2370834                 9        N    16093           5       N          5
2370901                 9        N    16093           5       N          5
2370902                 9        N    16093           5       N          5
2370903                 9        N    16093           5       N          5
2370904                 9        N    16093           5       N          5
2370905                 9        N    16093           5       N          5
2370906                 9        N    16093           5       N          5
         temp temp.qc dew.point dew.point.qc atm.press atm.press.qc        rh
252417   -0.2       5      -1.4            5        NA            9  91.73041
252480   -0.1       5      -2.3            5        NA            9  85.31366
252482   -0.8       5      -3.1            5        NA            9  84.61308
252483   -0.2       5      -2.7            5        NA            9  83.45283
252484   -0.2       5      -3.0            5        NA            9  81.63822
252485   -0.8       5      -3.2            5        NA            9  83.99394
252486   -0.6       5      -3.0            5        NA            9  84.01786
252487   -1.0       5      -3.0            5        NA            9  86.47400
252488   -1.0       5      -3.2            5        NA            9  85.21392
252489   -2.4       5      -3.7            5        NA            9  90.91475
252490   -0.8       5      -2.9            5        NA            9  85.86334
252998   -0.8       5      -2.2            5        NA            9  90.36750
253000   -0.1       5      -1.5            5        NA            9  90.41937
951475   -0.1       5      -6.4            5        NA            9  62.90558
1105455 -17.0       1        NA            9    1010.3            1        NA
1105457 -17.0       1        NA            9    1010.3            1        NA
1105459 -17.0       1        NA            9    1011.6            1        NA
1203053 -17.2       5        NA            9        NA            9        NA
1203054 -17.0       5        NA            9        NA            9        NA
1203055 -17.2       5        NA            9        NA            9        NA
1203128 -17.2       5        NA            9        NA            9        NA
1203129 -17.2       5        NA            9        NA            9        NA
1203221 -17.0       6        NA            9        NA            9        NA
1203222 -17.2       5        NA            9        NA            9        NA
1203223 -17.0       6        NA            9        NA            9        NA
1203224 -17.0       6        NA            9        NA            9        NA
1203225 -17.2       5        NA            9        NA            9        NA
1203226 -17.0       6        NA            9        NA            9        NA
1462938  -0.8       5      -4.1            5        NA            9  78.59767
1462939  -1.5       5      -4.5            5        NA            9  80.26033
2091732  -1.0       C      -1.0            C        NA            9 100.00000
2356459  -1.7       5      -2.8            5    1021.8            5  92.30620
2356482  -0.6       5      -2.2            5    1023.3            5  89.07677
2356483  -1.1       5      -2.8            5    1023.7            5  88.38577
2356484  -1.7       5      -3.3            5    1024.7            5  88.98380
2367816  -0.6       5      -4.4            5    1019.7            5  75.76745
2370112  -1.0       C      -1.0            C        NA            9 100.00000
2370113  -1.0       5      -1.0            5        NA            9 100.00000
2370114  -1.0       5      -1.0            5        NA            9 100.00000
2370115  -1.0       C      -2.0            C        NA            9  93.02209
2370686  -1.0       C      -2.0            C        NA            9  93.02209
2370687  -1.0       5      -3.0            5        NA            9  86.47400
2370688  -2.0       5      -3.0            5        NA            9  92.96690
2370689  -2.0       C      -4.0            C        NA            9  86.37048
2370690  -2.0       5      -3.0            5        NA            9  92.96690
2370752  -1.0       C      -4.0            C        NA            9  80.33283
2370753  -1.0       5      -3.0            5        NA            9  86.47400
2370754  -2.0       5      -4.0            5        NA            9  86.37048
2370755  -2.0       C      -3.0            C        NA            9  92.96690
2370756  -2.0       5      -4.0            5        NA            9  86.37048
2370757  -2.0       5      -4.0            5        NA            9  86.37048
2370758  -3.0       C      -5.0            C        NA            9  86.26537
2370759  -3.0       5      -4.0            5        NA            9  92.91083
2370760  -3.0       5      -4.0            5        NA            9  92.91083
2370761  -3.0       C      -4.0            C        NA            9  92.91083
2370762  -2.0       5      -4.0            5        NA            9  86.37048
2370763  -1.0       5      -3.0            5        NA            9  86.47400
2370829  -1.0       5      -4.0            5        NA            9  80.33283
2370830  -1.0       C      -3.0            C        NA            9  86.47400
2370831  -1.0       5      -4.0            5        NA            9  80.33283
2370832  -2.0       5      -5.0            5        NA            9  80.18729
2370833  -2.0       C      -4.0            C        NA            9  86.37048
2370834  -1.0       5      -4.0            5        NA            9  80.33283
2370901  -1.0       5      -4.0            5        NA            9  80.33283
2370902  -1.0       C      -4.0            C        NA            9  80.33283
2370903  -1.0       5      -4.0            5        NA            9  80.33283
2370904  -1.0       5      -4.0            5        NA            9  80.33283
2370905  -1.0       C      -4.0            C        NA            9  80.33283
2370906  -1.0       5      -4.0            5        NA            9  80.33283</code></pre>
</div>
</div>
<p>According to a National Weather Service page, the lowest minimum temperature for Midland, Texas in August is 52 degrees Fahrenheit, or 11.1 degrees Celsius.</p>
<p><strong>Source:</strong> “August Daily Temperature Records And Averages.” National Weather Service (Weather.gov), Weather Forecast Office Midland/Odessa, n.d., https://www.weather.gov/maf/cli_maf_temp_august. Accessed 30 Jan.&nbsp;2026.</p>
<p>Therefore, this value seems too unreasonable for temperatures in the US in August, so we remove all temperature values of -17 or less and check again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>met <span class="ot">&lt;-</span> met[<span class="sc">!</span><span class="fu">is.na</span>(met<span class="sc">$</span>temp) <span class="sc">&amp;</span> met<span class="sc">$</span>temp <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">17</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -3.00   19.60   23.50   23.59   27.80   56.00 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>met[<span class="sc">!</span><span class="fu">is.na</span>(met<span class="sc">$</span>temp) <span class="sc">&amp;</span> met<span class="sc">$</span>temp <span class="sc">==</span> <span class="dv">56</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      USAFID  WBAN year month day hour min    lat      lon elev wind.dir
42403 720267 23224 2019     8  26   11  15 38.955 -121.081  467       NA
      wind.dir.qc wind.type.code wind.sp wind.sp.qc ceiling.ht ceiling.ht.qc
42403           9              C       0          5      22000             5
      ceiling.ht.method sky.cond vis.dist vis.dist.qc vis.var vis.var.qc temp
42403                 9        N    16093           5       N          5   56
      temp.qc dew.point dew.point.qc atm.press atm.press.qc rh
42403       5        NA            9        NA            9 NA</code></pre>
</div>
</div>
<p>The minimum temperature is now much more reasonable, although the maximum should still be scrutinized. According to the World Meterological Organization, the highest temperature ever recorded on Earth was 56.7 degrees Celsius; however, this was recorded in Death Valley, California, which is in the US. Therefore, we leave the rest of the data as is.</p>
<p><strong>Source:</strong> “Records of Weather and Climate Extremes Table.” World Meteorological Organization, 31 July 2025, https://wmo.int/files/records-of-weather-and-climate-extremes-table . Accessed 30 Jan.&nbsp;2026.</p>
<p>Now, we replace values of 9999 in the “elev” variable with NA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>met<span class="sc">$</span>elev[met<span class="sc">$</span>elev <span class="sc">==</span> <span class="dv">9999</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(met<span class="sc">$</span>elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  -13.0   101.0   252.0   414.3   400.0  4113.0     182 </code></pre>
</div>
</div>
<p>We see from the summary of “elev” that the highest elevation (of 4,113 m) is still very large compared to the mean and median elevations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(met<span class="sc">$</span>elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>According to the histogram, all of the elevations in the data appear to make sense; a few negative elevations below sea level were recorded, but most of the observations were very close to sea level, which is to be expected for populated sites such as airports. The highest elevation (4,113 m) is plausible for stations at high altitudes such as mountainous regions. According to the U.S. Geological Survey, the highest altitude in the US is Denali in Alaska, which is 20,320 feet (or 6,193.54 m) above sea level, further corroborating the validity of the data.</p>
<p><strong>Source:</strong> “Highest and Lowest Elevations.” U.S. Geological Survey, U.S. Geological Survey, n.d., https://www.usgs.gov/educational-resources/highest-and-lowest-elevations . Accessed 30 Jan.&nbsp;2026.</p>
</section>
<section id="calculate-summary-statistics" class="level1">
<h1>6. Calculate summary statistics</h1>
<p>We pick the weather station with maximum elevation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>met<span class="sc">$</span>station_id <span class="ot">&lt;-</span> <span class="fu">paste</span>(met<span class="sc">$</span>USAFID, met<span class="sc">$</span>WBAN, <span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>max_elev <span class="ot">&lt;-</span> <span class="fu">max</span>(met<span class="sc">$</span>elev, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>top_station <span class="ot">&lt;-</span> met<span class="sc">$</span>station_id[<span class="fu">which</span>(met<span class="sc">$</span>elev <span class="sc">==</span> max_elev)[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Within that station, we examine the correlation between temperature and wind speed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>elev <span class="ot">&lt;-</span> met[met<span class="sc">$</span>station_id <span class="sc">==</span> top_station, ]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(elev<span class="sc">$</span>temp, elev<span class="sc">$</span>wind.sp, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1163212</code></pre>
</div>
</div>
<p>We find that this correlation is only slightly negative (i.e.&nbsp;wind.sp decreases only slightly as temperature decreases, but they are not closely correlated).</p>
<p>Now, we look at the correlations between temp, wind.sp, hour, and day:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">temp_wind =</span> <span class="fu">cor</span>(elev<span class="sc">$</span>temp, elev<span class="sc">$</span>wind.sp, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">temp_hour =</span> <span class="fu">cor</span>(elev<span class="sc">$</span>temp, elev<span class="sc">$</span>hour,   <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">wind_hour =</span> <span class="fu">cor</span>(elev<span class="sc">$</span>wind.sp, elev<span class="sc">$</span>hour, <span class="at">use =</span> <span class="st">"complete.obs"</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">wind_day  =</span> <span class="fu">cor</span>(elev<span class="sc">$</span>wind.sp, elev<span class="sc">$</span>day,  <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  temp_wind   temp_hour   wind_hour    wind_day 
-0.11632121  0.44209914  0.07249456  0.35034544 </code></pre>
</div>
</div>
<p>We find that the highest correlation is between temperature and hour, followed by wind speed and day. Temperature and wind speed (as well as wind speed and hour) do not appear to be highly correlated with each other.</p>
</section>
<section id="exploratory-graphs" class="level1">
<h1>7. Exploratory graphs</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(met<span class="sc">$</span>elev, <span class="at">main =</span> <span class="st">"Histogram of Elevations"</span>, <span class="at">xlab =</span> <span class="st">"Elevation (m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(met<span class="sc">$</span>temp, <span class="at">main =</span> <span class="st">"Histogram of Temperatures"</span>, <span class="at">xlab =</span> <span class="st">"Temperature (degrees Celsius)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(met<span class="sc">$</span>wind.sp, <span class="at">main =</span> <span class="st">"Histogram of Wind Speeds"</span>, <span class="at">xlab =</span> <span class="st">"Wind Speed (m/s)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histograms, we find that most elevations are below 1,000 m (as validated previously), the temperatures are normally distributed around 25 degrees Celsius (which is roughly room temperature), and the wind speeds are mostly less than 5 meters per second. Thus, all of the data now appears reasonable.</p>
<p>We also look at the time series of temperature vs.&nbsp;wind speed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(elev) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">'OpenStreetMap'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircles</span>(<span class="at">lat=</span><span class="sc">~</span>lat,<span class="at">lng=</span><span class="sc">~</span>lon, <span class="at">opacity=</span><span class="dv">1</span>, <span class="at">fillOpacity=</span><span class="dv">1</span>, <span class="at">radius=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-89ee744e05488f009756" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-89ee744e05488f009756">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircles","args":[[39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.795,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.8,39.795,39.795,39.795,39.795,39.795],[-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.764,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.766,-105.764,-105.764,-105.764,-105.764,-105.764],100,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":1,"fill":true,"fillColor":"#03F","fillOpacity":1},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[39.795,39.8],"lng":[-105.766,-105.764]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>elev<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">with</span>(elev, <span class="fu">ymd_h</span>(<span class="fu">paste</span>(year, month, day, hour, <span class="at">sep=</span> <span class="st">' '</span>)))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(elev<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Min.               1st Qu.                Median 
"2019-08-01 00:00:00" "2019-08-08 17:00:00" "2019-08-16 11:30:00" 
                 Mean               3rd Qu.                  Max. 
"2019-08-16 11:35:23" "2019-08-24 05:45:00" "2019-08-31 23:00:00" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>elev <span class="ot">&lt;-</span> elev[<span class="fu">order</span>(elev<span class="sc">$</span>date), ]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(elev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       USAFID WBAN year month day hour min  lat      lon elev wind.dir
221697 720385  419 2019     8   1    0  36 39.8 -105.766 4113      170
221698 720385  419 2019     8   1    0  54 39.8 -105.766 4113      100
221699 720385  419 2019     8   1    1  12 39.8 -105.766 4113       90
221700 720385  419 2019     8   1    1  35 39.8 -105.766 4113      110
221701 720385  419 2019     8   1    1  53 39.8 -105.766 4113      120
221702 720385  419 2019     8   1    2  12 39.8 -105.766 4113      120
       wind.dir.qc wind.type.code wind.sp wind.sp.qc ceiling.ht ceiling.ht.qc
221697           5              N     8.8          5       1372             5
221698           5              N     2.6          5       1372             5
221699           5              N     3.1          5       1981             5
221700           5              N     4.1          5       2134             5
221701           5              N     4.6          5       2134             5
221702           5              N     6.2          5      22000             5
       ceiling.ht.method sky.cond vis.dist vis.dist.qc vis.var vis.var.qc temp
221697                 M        N       NA           9       N          5    9
221698                 M        N       NA           9       N          5    9
221699                 M        N       NA           9       N          5    9
221700                 M        N       NA           9       N          5    9
221701                 M        N       NA           9       N          5    9
221702                 9        N       NA           9       N          5    9
       temp.qc dew.point dew.point.qc atm.press atm.press.qc       rh
221697       5         1            5        NA            9 57.61039
221698       5         1            5        NA            9 57.61039
221699       5         2            5        NA            9 61.85243
221700       5         2            5        NA            9 61.85243
221701       5         2            5        NA            9 61.85243
221702       5         2            5        NA            9 61.85243
       station_id                date
221697 720385-419 2019-08-01 00:00:00
221698 720385-419 2019-08-01 00:00:00
221699 720385-419 2019-08-01 01:00:00
221700 720385-419 2019-08-01 01:00:00
221701 720385-419 2019-08-01 01:00:00
221702 720385-419 2019-08-01 02:00:00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(elev<span class="sc">$</span>date, elev<span class="sc">$</span>temp, <span class="at">main =</span> <span class="st">"Temperature Time-Series Plot for Highest-Elevation Station"</span>, <span class="at">xlab =</span> <span class="st">"Date"</span>, <span class="at">ylab =</span> <span class="st">"Temperature (degrees Celsius)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this time-series plot, we find that the temperature tends to oscillate from day to day and does not generally increase or decrease, which is to be expected. However, the coldest points in the series are around August 12, 18, and 28, which are especially low temperatures of less than 4 degrees Celsius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(elev<span class="sc">$</span>date, elev<span class="sc">$</span>wind.sp, <span class="at">main =</span> <span class="st">"Wind Speed Time-Series Plot for Highest-Elevation Station"</span>, <span class="at">xlab =</span> <span class="st">"Date"</span>, <span class="at">ylab =</span> <span class="st">"Wind Speed (m/s)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For this time-series plot, we find that the general trend of wind speed increased gradually from August 1st to 19th, but dropped sharped on August 19th before climbing to a high of over 20 m/s on August 26; the wind speed then decreased until September.</p>
</section>
<section id="ask-questions" class="level1">
<h1>8. Ask questions</h1>
<p>Here are some additional specific exploratory questions I had about this data:</p>
<p>Which hours in the day have the most recorded observations?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(met<span class="sc">$</span>hour), <span class="at">main =</span> <span class="st">"Counts by hour"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(met<span class="sc">$</span>day),  <span class="at">main =</span> <span class="st">"Counts by day of month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These bar graphs show that the measurements per hour in a day and per day in a month are fairly evenly distributed, although there seems to be a small drop in observations on the 29th day of the month on average.</p>
<p>How does the average temperature vary per the hour at which it was recorded?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">tapply</span>(met<span class="sc">$</span>temp, met<span class="sc">$</span>hour, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"Hour"</span>, <span class="at">ylab =</span> <span class="st">"Mean Temperature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We find that the average temperature is lowest (20 degrees Celsius) at hour 12, which corresponds to noon in UTC. This appears to not make sense, but the time zones in the US are significantly shifted from UTC; what is most important is the general oscillation of temperature for each hour in the day, which is expected.</p>
<p>What about the average wind speed per hour recorded?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">tapply</span>(met<span class="sc">$</span>wind.sp, met<span class="sc">$</span>hour, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">"Hour"</span>, <span class="at">ylab =</span> <span class="st">"Mean Wind Speed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows that the wind speed oscillates in the same way as temperature, which is also expected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(met<span class="sc">$</span>lon, met<span class="sc">$</span>lat, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Are higher-elevation stations colder on average? To measure this without plotting all 230,000+ observations, we can sort the observations into bins based on their elevation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>elevations <span class="ot">&lt;-</span> <span class="fu">cut</span>(met<span class="sc">$</span>elev, <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">tapply</span>(met<span class="sc">$</span>temp, elevations , mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(m, <span class="at">las =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">"Elevation bin"</span>, <span class="at">ylab =</span> <span class="st">"Mean temperature (°C)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This bar plot shows us that higher elevations indeed tend to have colder temperatures in their observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(met)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "USAFID"            "WBAN"              "year"             
 [4] "month"             "day"               "hour"             
 [7] "min"               "lat"               "lon"              
[10] "elev"              "wind.dir"          "wind.dir.qc"      
[13] "wind.type.code"    "wind.sp"           "wind.sp.qc"       
[16] "ceiling.ht"        "ceiling.ht.qc"     "ceiling.ht.method"
[19] "sky.cond"          "vis.dist"          "vis.dist.qc"      
[22] "vis.var"           "vis.var.qc"        "temp"             
[25] "temp.qc"           "dew.point"         "dew.point.qc"     
[28] "atm.press"         "atm.press.qc"      "rh"               
[31] "station_id"       </code></pre>
</div>
</div>
<p>Finally, what are the correlations between variables? We can use a correlation heatmap to visualize this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>num <span class="ot">&lt;-</span> met[<span class="fu">sapply</span>(met, is.numeric)]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep columns with a nonzero standard deviation</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">sapply</span>(num, <span class="cf">function</span>(x) <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>num2 <span class="ot">&lt;-</span> num[, keep]</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">cor</span>(num2, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="lab-03_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There appears to be a strong correlation between relative humidity (rh) and dew point (the temperature air must cool to for water vapor to condense), which makes sense scientifically. Also, latitude and longitude can sometimes be slightly correlated due to stations being located in certain places across the U.S. Interestingly, we also see a correlation between atmospheric pressure and relative humidity, which may be because pressure affects the density of water vapor, such that a lower pressure brings higher humidity and more rain.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>